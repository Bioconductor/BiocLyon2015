---
title: "L6 -- Visualization"
author: "Martin Morgan<br />
         Roswell Park Cancer Institute, Buffalo, NY<br />
         26-28 October, 2015"
output:
  BiocStyle::html_document:
    toc: true
    toc_depth: 2
vignette: >
  % \VignetteIndexEntry{L6 - Visualization}
  % \VignetteEngine{knitr::rmarkdown}
---

```{r style, echo = FALSE, results = 'asis'}
BiocStyle::markdown()
options(width=100, max.print=1000)
knitr::opts_chunk$set(
    eval=as.logical(Sys.getenv("KNITR_EVAL", "TRUE")),
    cache=as.logical(Sys.getenv("KNITR_CACHE", "TRUE")))
```

- Challenges to visualizing genomic data. Opportunities for familiar
  and novel genomic visualizations in Bioconductor. Approaches to
  interactive visualization with shiny. Adopting strategies for
  reproducible and collaborative research. Primary packages: [Gviz][],
  [shiny][].

# _Gviz_

Genomic visualizations

## Exercise: Review section 2 of the [Gviz][] vignette

## Exercise: Gene model and BAM data

Visualize a BAM file from [RNAseqData.HNRNPC.bam.chr14][] around the
HNRNPC gene. Do this by creating an gene region track...

```{r}
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
genes <- GeneRegionTrack(TxDb.Hsapiens.UCSC.hg19.knownGene, chromosome="chr14")
```
   
...a data track...

```{r}
library(RNAseqData.HNRNPC.bam.chr14)
fl <- RNAseqData.HNRNPC.bam.chr14_BAMFILES[1]
data <- DataTrack(range=fl, name=names(fl),
    type="histogram", window= -1,
    genome="hg19", chromosome="chr14")
```
 
...the region of interest for HNRNPC...

```{r}
library(org.Hs.eg.db)
egid <- mapIds(org.Hs.eg.db, "HNRNPC", "ENTREZID", "SYMBOL")
gene <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene)[egid]
```

and plotting
 
```{r}
plotTracks(c(genes, data),
    from=start(gene), to=end(gene), chr="chr14", windowSize=30)
```

Add additional BAM files to the figure. Can you adjust the gene being
displayed?

# Interactivity

Create a fun shiny application

Advanced: implement _BAMSpector_ to explore BAM files in the context
of known gene annotation.

# Lab: _ReportingTools_

Transform the RNA-seq differential expression work flow into a
_ReportingTools_ report.
